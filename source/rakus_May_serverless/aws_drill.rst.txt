ç§˜å¯†1ï¼šAWSãƒ‰ãƒªãƒ«ã‚’å‚è€ƒã«ã—ã¾ã—ãŸ
============================================================

ã”å­˜çŸ¥ã§ã™ã‹ï¼Ÿ builders.flash
--------------------------------------------------

https://aws.amazon.com/jp/builders-flash/

builders.flash
--------------------------------------------------

* *AWS ã®ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼å‘ã‘ã‚¦ã‚§ãƒ–ãƒã‚¬ã‚¸ãƒ³*
* ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒˆã®çš†æ§˜ã«ã‚ˆã‚‹ **è±Šå¯Œãªè¨˜äº‹**
* ãƒ¡ãƒ¼ãƒ«ãƒ¡ãƒ³ãƒãƒ¼ã«ç™»éŒ²ã™ã‚‹ã¨ã€ç‰¹å…¸ï¼ˆAWSã®ã‚¯ãƒ¼ãƒãƒ³ï¼‰ã„ãŸã ã‘ã¾ã™

ãŠå½¹ç«‹ã¡ Twitter Bot ã‚’ä½œã‚ŠãªãŒã‚‰å­¦ã¶ AWS ãƒ‰ãƒªãƒ«
--------------------------------------------------

é‡‘æ¾¤ã•ã‚“ï¼ˆa.k.a `@ketancho <https://twitter.com/ketancho>`_ ã•ã‚“ï¼‰ã«ã‚ˆã‚‹æ¯æœˆé€£è¼‰ï¼ˆ2022å¹´1æœˆã€œï¼‰

    Twitter Bot ã‚’é–‹ç™ºãƒ»é‹ç”¨ã—ãªãŒã‚‰ AWS ã‚’å­¦ã‚“ã§ã„ãŸã ãã¾ã™ã€‚ï¼ˆç¬¬1å›ã‚ˆã‚Šï¼‰

ç¾åœ¨5ï¸âƒ£å›é€£è¼‰
--------------------------------------------------

* `ç¬¬1å› <https://aws.amazon.com/jp/builders-flash/202201/aws-drill-twitter-bot-1/>`_ AWS Lambdaãƒ»Amazon EventBridgeãƒ»AWS CloudShell
* `ç¬¬2å› <https://aws.amazon.com/jp/builders-flash/202202/aws-drill-twitter-bot-2/>`_ Amazon DynamoDBãƒ»AWS IAM
* `ç¬¬3å› <https://aws.amazon.com/jp/builders-flash/202203/aws-drill-twitter-bot-3/>`_ AWS Systems Manager (Parameter Store)

.. revealjs-break::

* `ç¬¬4å› <https://aws.amazon.com/jp/builders-flash/202204/aws-drill-twitter-bot-4/>`_ Amazon SNS
* `ç¬¬5å› <https://aws.amazon.com/jp/builders-flash/202205/aws-drill-twitter-bot-5/>`_ Amazon Translate
* ä»Šå¾Œã‚‚æ¥½ã—ã¿ã«ã—ã¦ã„ã¾ã™ï¼

harmonizer_botã¯ **åˆå›** ã®å†…å®¹ã§ä½œã‚Šã¾ã—ãŸ
--------------------------------------------------

* ç¬¬3å›ã‚‚ä¸€éƒ¨å‚ç…§ã—ã¦ã„ã¾ã™
* ãƒ‰ãƒªãƒ«4å›åˆ†æ®‹ã—ã¦ã„ã‚‹ã®ã§ã€æ‹¡å¼µã—ãŒã„ãŒã‚ã£ã¦æœ€é«˜ï¼

AWSãƒ‰ãƒªãƒ«ç¬¬1å›ã§ä½œã‚‹Twitter Bot
============================================================

https://aws.amazon.com/jp/builders-flash/202201/aws-drill-twitter-bot-1/

Twitter Botã®ä»•çµ„ã¿
--------------------------------------------------

* Botç”¨ã®Twitterã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç”¨æ„
* Twitter APIã‚’ä»‹ã™ã¨ã€Twitterã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ãƒ„ã‚¤ãƒ¼ãƒˆã•ã›ã‚‰ã‚Œã‚‹
* ã¤ã¾ã‚Šã€Twitter Botï¼ **Botç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ **

Botç”¨Twitterã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®è¨­å®š
--------------------------------------------------

* Twitter API **v2** ã® Essential access ã¯ç”³è«‹ä¸è¦ã§ä½¿ãˆã‚‹ï¼
* Botç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§developer accountã‚’ç™»éŒ²ã—ã€APIã®ã‚­ãƒ¼ã‚„ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ‰•ã„å‡ºã™
* è©³ã—ãã¯ https://developer.twitter.com/en/docs/twitter-api/getting-started/getting-access-to-the-twitter-api

ãƒ„ã‚¤ãƒ¼ãƒˆã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
--------------------------------------------------

.. code-block::

    POST https://api.twitter.com/2/tweets

* ãƒ‰ãƒªãƒ«ã«æ²¿ã£ã¦ã€OAuth 1.0a User Contextã‚’ä½¿ã£ã¦ã„ã¾ã™
* https://developer.twitter.com/en/docs/twitter-api/tweets/manage-tweets/api-reference/post-tweets

ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼ˆPythonï¼‰
--------------------------------------------------

.. code-block:: python

    import os
    from requests_oauthlib import OAuth1Session

    # ç’°å¢ƒå¤‰æ•°ã®èª­ã¿è¾¼ã¿
    consumer_key = os.getenv("TWITTER_API_KEY")
    client_secret = os.getenv("TWITTER_API_KEY_SECRET")
    access_token = os.getenv("TWITTER_API_ACCESS_TOKEN")
    access_token_secret = os.getenv("TWITTER_API_ACCESS_TOKEN_SECRET")

    oauth = OAuth1Session(consumer_key, client_secret, access_token, access_token_secret)

    payload = {"text": "#ã‚¢ã‚¤ã®æ­Œå£°ã‚’è´ã‹ã›ã¦ é¢ç™½ã„ã‹ã‚‰ã¿ã‚“ãªè¦³ã¦"}
    response = oauth.post("https://api.twitter.com/2/tweets", json=payload)

Twitter Botã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’AWSã§å‹•ã‹ã™
============================================================

ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ã€å®šæœŸçš„ã«è‡ªå‹•ã§å®Ÿè¡Œã€‚ãã‚Œã™ãªã‚ã¡Bot

Twitter Botã®æœ€å°æ§‹æˆã¯2ã¤ã®ã‚µãƒ¼ãƒ“ã‚¹
--------------------------------------------------

* AWS Lambda
* Amazon EventBridge

.. å›³ã‚’ã“ã“ã«å…¥ã‚Œã‚‹ã‹ã‚‚

AWS Lambda
--------------------------------------------------

* å…ˆã®ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’Lambdaé–¢æ•°ã«ã™ã‚‹

  * :file:`lambda_function.py` ã® ``lambda_handler`` é–¢æ•°ã¨ã—ã¦å®Ÿè£…ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã«åˆã‚ã›ã‚‹ï¼‰

* ï¼ˆæ‰‹ã«é¦´æŸ“ã‚“ã è¨€èªã«æ›¸ãæ›ãˆã¦ã‚‚ç´ æŒ¯ã‚Šã«ãªã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã­ï¼‰

ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹Lambdaé–¢æ•°ã®ä¾‹
--------------------------------------------------

.. code-block:: python

    import os
    from requests_oauthlib import OAuth1Session

    consumer_key = os.getenv("TWITTER_API_KEY")
    client_secret = os.getenv("TWITTER_API_KEY_SECRET")
    access_token = os.getenv("TWITTER_API_ACCESS_TOKEN")
    access_token_secret = os.getenv("TWITTER_API_ACCESS_TOKEN_SECRET")

    oauth = OAuth1Session(consumer_key, client_secret, access_token, access_token_secret)

    def lambda_handler(event, context):
        payload = {"text": "#ã‚¢ã‚¤ã®æ­Œå£°ã‚’è´ã‹ã›ã¦ é¢ç™½ã„ã‹ã‚‰ã¿ã‚“ãªè¦³ã¦"}
        response = oauth.post("https://api.twitter.com/2/tweets", json=payload)

Amazon EventBridge
--------------------------------------------------

* Lambdaé–¢æ•°ã¯eventï¼ˆJSONï¼‰ã‚’å—ã‘å–ã‚‹ã¨å®Ÿè¡Œã•ã‚Œã‚‹ï¼ˆ``lambda_handler`` é–¢æ•°ã®ç¬¬1å¼•æ•°ï¼‰
* EventBridgeã§eventã‚’ **ç™ºç”Ÿ** ã•ã›ã‚‹

  * å®šæœŸçš„ã«ã€Lambdaé–¢æ•°ã«å¯¾ã—ã¦ï¼ˆğŸ‘‰Lambdaé–¢æ•°ã®æ—¥æ¬¡å®Ÿè¡Œï¼‰

ã“ã†ã—ã¦ã€æ¯æœã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã™ã‚‹BotãŒçˆ†èª•ã—ãŸğŸ‰
============================================================

.. raw:: html

    <blockquote class="twitter-tweet" data-align="center" data-dnt="true"><p lang="ja" dir="ltr">3/21ã¯ <a href="https://twitter.com/hashtag/%E3%82%A2%E3%82%A4%E3%81%AE%E6%AD%8C%E5%A3%B0%E3%82%92%E8%81%B4%E3%81%8B%E3%81%9B%E3%81%A6?src=hash&amp;ref_src=twsrc%5Etfw">#ã‚¢ã‚¤ã®æ­Œå£°ã‚’è´ã‹ã›ã¦</a> å…¬é–‹ã‹ã‚‰144æ—¥ç›®ã§ã™ã€‚<br>ä»Šæ—¥ã‚‚ã€å…ƒæ°—ã§ã€é ‘å¼µã‚‹ãã£ã€ãŠãƒ¼ã£</p>&mdash; sing_a_bot_of_harmony (@harmonizer_bot) <a href="https://twitter.com/harmonizer_bot/status/1505680602942492674?ref_src=twsrc%5Etfw">March 20, 2022</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

LTï¼šã‚¢ã‚¤ã®æ­Œå£°ã‚’è´ã‹ã›ã¦å¿œæ´Botã®ç§˜å¯†ã¯ã­ã€æœ€å¾Œã˜ã‚ƒãªã„ã‘ã©æ˜ã‹ã•ã‚Œã‚‹ã‚“ã ã‚ˆ
--------------------------------------------------------------------------------

* ç§˜å¯†1ï¼š **AWSãƒ‰ãƒªãƒ«** ã‚’å‚è€ƒã«ã—ã¾ã—ãŸ
* ç§˜å¯†2
* ç§˜å¯†3

NEXTï¼š1æ—¥ã«è¤‡æ•°å›ã¤ã¶ã‚„ã‹ã›ã‚‹ã«ã¯ï¼ŸğŸ¤”
--------------------------------------------------

* Lambdaé–¢æ•°ã‚’ã¤ã¶ã‚„ãã®ç¨®é¡ã ã‘ä½œã‚‹ï¼Ÿ
* 1ã¤ã®Lambdaé–¢æ•°ã®ä¸­ã§ã€ã“ã®æ™‚é–“ã¯ã“ã®ã¤ã¶ã‚„ãã¨ã„ã†ãƒ­ã‚¸ãƒƒã‚¯ã‚’æ›¸ãï¼Ÿ
